NewVisitorScreen_2 As screen:
    BackgroundImage: ='Background Image'
    Fill: =RGBA(0, 0, 0, 0)
    ImagePosition: =ImagePosition.Fill
    OnVisible: =Collect(VisitorPhoneNumber,VisitorInformation)

    infoLbl_6 As label:
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Height: =80
        Size: =28
        Text: ="New Visitor Information"
        Width: =536
        X: =416
        Y: =99
        ZIndex: =3

    btnSubmit_4 As button:
        BorderStyle: =BorderStyle.None
        Color: =RGBA(0, 0, 0, 1)
        Fill: =RGBA(210, 215, 218, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, 75%)
        Font: =Font.'Lato Black'
        Height: =58
        OnSelect: |+
            =If(
                !IsEmpty(Errors(VisitorInformation)),
                    Notify(
                        First(Errors(VisitorInformation)).Message,
                        NotificationType.Error
                        
                    ),
                    If(IsEmpty(LookUp(VisitorInformation, 'Phone Number' = visitorPhoneNumber_2.Text)),
                        Notify("Phone Number already exists. Enter your correct phone number."),
                        Patch(
                            VisitorInformation,
                            visitorsDetail_3.Updates
                        );    
                        Office365Outlook.SendEmailV2(visitorEmail_2,"Visitor Registration to Astral Computers Nepal Pvt. Ltd.","You                          have been successfully registered as a visitor in the organization. Please checkin as a regular visitor with your                  phone number while visiting the organization. Thank You!" & Link),
            
                        Reset(salutation_2);
                        Reset(visitorFullName_2);
                        Reset(visitorCompany_2);
                        Reset(visitorEmail_2);
                        ResetForm(visitorsDetail_3);
                        Navigate(VisitorInfoScreen)
                    ) 
                    &&        
                    Notify(
                        "Success",
                        NotificationType.Success
                    )   
            );
            
            
            Reset(visitorPhoneNumber_2);
            
        Size: =20
        Text: ="Submit"
        Width: =207
        X: =580
        Y: =670
        ZIndex: =4

    homeicon_6 As icon.Home:
        Color: =RGBA(9, 33, 98, 1)
        Icon: =Icon.Home
        OnSelect: =Navigate(MainScreen)
        X: =1236
        Y: =96
        ZIndex: =5

    visitorsDetail_3 As form:
        AcceptsFocus: =false
        BorderThickness: =3
        DataSource: =VisitorInformation
        DefaultMode: =FormMode.New
        Height: =477
        NumberOfColumns: =2
        SnapToColumns: =false
        Width: =1252
        X: =46
        Y: =177
        ZIndex: =6

        VisitorPhoto_DataCard1_1 As typedDataCard.addLargePictureCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="VisitorPhoto"
            Default: =ThisItem.VisitorPhoto
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@VisitorInformation],DataSourceInfo.DisplayName,"VisitorPhoto")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =295
            Required: =false
            Update: =Image2_1.Image
            Width: =1248
            X: =0
            Y: =3
            ZIndex: =1

            DataCardKey12_1 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =33
                Text: =Parent.DisplayName
                Width: =161
                Wrap: =false
                X: =579
                Y: =19
                ZIndex: =1

            ErrorMessage7_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =Image2_1.Y + Image2_1.Height
                ZIndex: =4

            StarVisible7_1 As label:
                Align: =Align.Center
                Height: =DataCardKey12_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey12_1.Y
                ZIndex: =5

            right_6 As icon.Check:
                Color: =If(Self.Icon=Icon.Check, Green, Red)
                DisplayMode: =DisplayMode.View
                Height: =38
                Icon: =If(!IsBlank(Image2_1), Icon.Check, Icon.Cancel)
                Width: =46
                X: =731
                Y: =14
                ZIndex: =8

            Group1 As group:
                Height: =5
                Width: =5
                X: =40
                Y: =40
                ZIndex: =9

                Image2_1 As image:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    DisplayMode: =Parent.DisplayMode
                    Height: =227
                    Image: =Camera1_1.Photo
                    Tooltip: =Parent.DisplayName
                    Width: =294
                    X: =523
                    Y: =64
                    ZIndex: =2

                Camera1_1 As camera:
                    Camera: =0
                    Height: =Image2_1.Height
                    OnSelect: =true
                    OnStream: =true
                    Width: =Image2_1.Width
                    X: =523
                    Y: =64
                    ZIndex: =6

        Gender_DataCard1_2 As typedDataCard.comboBoxEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="Gender"
            Default: =
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@VisitorInformation],DataSourceInfo.DisplayName,"Gender")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =60
            Required: =false
            Update: =visitorGender_2.Selected
            Visible: =false
            Width: =624
            X: =0
            Y: =0
            ZIndex: =6

            DataCardKey4_2 As label:
                AutoHeight: =true
                Font: =Font.'Lato Black'
                FontWeight: =FontWeight.Semibold
                Height: =34
                Text: =Parent.DisplayName
                Width: =(Parent.Width - 60) * 0.4
                Wrap: =false
                X: =30
                Y: =14
                ZIndex: =1

            ErrorMessage4_2 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =40
                ZIndex: =3

            StarVisible4_2 As label:
                Align: =Align.Center
                Height: =DataCardKey4_2.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey4_2.Y
                ZIndex: =4

            visitorGender_2 As radio:
                BorderStyle: =BorderStyle.None
                Default: =If(salutation_2.Selected.Value="Mr.","Male","Female")
                Font: =Font.Lato
                FontWeight: =FontWeight.Semibold
                Height: =60
                Items: =Choices([@VisitorInformation].Gender)
                Layout: =Layout.Horizontal
                Tooltip: =If(!IsBlank(visitorGender_2.Selected), false, "Please choose your gender.")
                Width: =388
                X: =144
                ZIndex: =5

        Salutation_DataCard1_2 As typedDataCard.comboBoxEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="Salutation"
            Default: =ThisItem.Salutation
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@VisitorInformation],DataSourceInfo.DisplayName,"Salutation")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =29
            Required: =false
            Update: =salutation_2.Selected
            Width: =624
            X: =1
            Y: =0
            ZIndex: =6

            DataCardKey5_2 As label:
                AutoHeight: =true
                Font: =Font.'Lato Black'
                FontWeight: =FontWeight.Semibold
                Height: =33
                Text: =Parent.DisplayName
                Width: =(Parent.Width - 60) * 0.4
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            ErrorMessage5_2 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =44
                ZIndex: =3

            StarVisible5_2 As label:
                Align: =Align.Center
                Color: =RGBA(39, 67, 125, 1)
                DisabledColor: =RGBA(0, 0, 0, 0)
                DisplayMode: =DisplayMode.View
                Height: =DataCardKey5_2.Height
                Text: ="*"
                Width: =30
                Wrap: =false
                Y: =DataCardKey5_2.Y
                ZIndex: =4

            salutation_2 As radio:
                BorderStyle: =BorderStyle.None
                Font: =Font.Lato
                FontWeight: =FontWeight.Semibold
                Height: =54
                Items: =Choices([@VisitorInformation].Salutation)
                Layout: =Layout.Horizontal
                OnSelect: =If(ThisItem.Salutation.Value="Mr.",ThisItem.Gender.Value="Male",ThisItem.Gender.Value="Female")
                RadioSize: =30
                Reset: =true
                Tooltip: =If(!IsBlank(salutation_2.Selected), false, "The Field can not be blank")
                Width: =392
                X: =234
                ZIndex: =5

            right_13 As icon.Check:
                Color: =If(Self.Icon=Icon.Check, Green, Red)
                DisplayMode: =DisplayMode.View
                Height: =38
                Icon: =If(!IsBlank(salutation_2.Selected.Value), Icon.Check, Icon.Cancel)
                Width: =46
                X: =580
                Y: =8
                ZIndex: =6

        "'Full Name_DataCard1_2' As typedDataCard.textualEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="Title"
            Default: =ThisItem.'Full Name'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@VisitorInformation],DataSourceInfo.DisplayName,"Title")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =60
            MaxLength: =DataSourceInfo([@VisitorInformation], DataSourceInfo.MaxLength, "Title")
            Required: =true
            Update: =visitorFullName_2.Text
            Width: =624
            WidthFit: =false
            X: =0
            Y: =1
            ZIndex: =6

            StarVisible1_2 As label:
                Align: =Align.Center
                Height: =9
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =22
                ZIndex: =1

            ErrorMessage1_2 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =visitorFullName_2.Y + visitorFullName_2.Height
                ZIndex: =2

            visitorFullName_2 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Clear: =true
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =If(!IsBlank(visitorFullName_2.Text), "", "Name can not be blank")
                Width: =(Parent.Width - 60) * 0.6
                X: =235
                Y: =10
                ZIndex: =3

            DataCardKey1_2 As label:
                AutoHeight: =true
                DisplayMode: =DisplayMode.View
                Font: =Font.'Lato Black'
                FontWeight: =FontWeight.Semibold
                Height: =34
                Text: =Parent.DisplayName
                Width: =(Parent.Width - 60) * 0.4
                Wrap: =false
                X: =30
                Y: =10 + (visitorFullName_2.Height / 2) - (Self.Height / 2)
                ZIndex: =4

            right_14 As icon.Check:
                Color: =If(Self.Icon=Icon.Check, Green, Red)
                DisplayMode: =DisplayMode.View
                Height: =38
                Icon: =If(!IsBlank(visitorFullName_2.Text), Icon.Check, Icon.Cancel)
                Width: =46
                X: =578
                Y: =12
                ZIndex: =5

        Company_DataCard1_2 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="CompanyInfo"
            Default: =ThisItem.Company
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@VisitorInformation],DataSourceInfo.DisplayName,"CompanyInfo")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@VisitorInformation], DataSourceInfo.MaxLength, "CompanyInfo")
            Required: =true
            Update: =visitorCompany_2.Text
            Width: =624
            X: =1
            Y: =1
            ZIndex: =6

            DataCardKey3_2 As label:
                AutoHeight: =true
                Font: =Font.'Lato Black'
                FontWeight: =FontWeight.Semibold
                Height: =34
                Text: =Parent.DisplayName
                Width: =(Parent.Width - 60) * 0.4
                Wrap: =false
                X: =30
                Y: =10 + (visitorCompany_2.Height / 2) - (Self.Height / 2)
                ZIndex: =1

            visitorCompany_2 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Clear: =true
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =If(!IsBlank(visitorCompany_2.Text), "", "Company can not be blank")
                Width: =(Parent.Width - 60) * 0.6
                X: =225
                Y: =10
                ZIndex: =2

            ErrorMessage3_2 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =visitorCompany_2.Y + visitorCompany_2.Height
                ZIndex: =3

            StarVisible3_2 As label:
                Align: =Align.Center
                Height: =DataCardKey3_2.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey3_2.Y
                ZIndex: =4

            right_15 As icon.Check:
                Color: =If(Self.Icon=Icon.Check, Green, Red)
                DisplayMode: =DisplayMode.View
                Height: =38
                Icon: = If(!IsBlank(visitorCompany_2.Text), Icon.Check, Icon.Cancel)
                Width: =46
                X: =578
                Y: =12
                ZIndex: =5

        "'Email Address_DataCard1_2' As typedDataCard.textualEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="EmailAddress"
            Default: =ThisItem.'Email Address'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@VisitorInformation],DataSourceInfo.DisplayName,"EmailAddress")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@VisitorInformation], DataSourceInfo.MaxLength, "EmailAddress")
            Required: =true
            Update: =visitorEmail_2.Text
            Width: =624
            X: =0
            Y: =2
            ZIndex: =6

            DataCardKey2_2 As label:
                AutoHeight: =true
                Font: =Font.'Lato Black'
                FontWeight: =FontWeight.Semibold
                Height: =34
                Text: =Parent.DisplayName
                Width: =(Parent.Width - 60) * 0.4
                Wrap: =false
                X: =30
                Y: =10 + (visitorEmail_2.Height / 2) - (Self.Height / 2)
                ZIndex: =1

            visitorEmail_2 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Clear: =true
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                HintText: ="example@smt.com"
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: |-
                    =If(
                        !IsBlank(visitorEmail_2.Text),
                        "",
                        "Email can not be blank" && IsMatch(
                            visitorEmail_2.Text,
                            Match.Email
                        ),
                        "",
                        "the Email should be in the format example@example.com"
                    )
                Width: =(Parent.Width - 60) * 0.6
                X: =235
                Y: =10
                ZIndex: =2

            ErrorMessage2_2 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =visitorEmail_2.Y + visitorEmail_2.Height
                ZIndex: =3

            StarVisible2_2 As label:
                Align: =Align.Center
                Height: =DataCardKey2_2.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey2_2.Y
                ZIndex: =4

            right_16 As icon.Check:
                Color: =If(Self.Icon=Icon.Check, Green, Red)
                DisplayMode: =DisplayMode.View
                Height: =38
                Icon: |-
                    = If(!IsBlank(visitorEmail_2.Text)&&IsMatch(
                            visitorEmail_2.Text,
                            Email),Icon.Check, Icon.Cancel)
                Width: =46
                X: =578
                Y: =12
                ZIndex: =5

        "'Phone Number_DataCard1_2' As typedDataCard.textualEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="Phone_x0020_Number"
            Default: =ThisItem.'Phone Number'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@VisitorInformation],DataSourceInfo.DisplayName,"Phone_x0020_Number")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@VisitorInformation], DataSourceInfo.MaxLength, "Phone_x0020_Number")
            Required: =true
            Update: =visitorPhoneNumber_2.Text
            Width: =624
            X: =1
            Y: =2
            ZIndex: =6

            DataCardKey6_2 As label:
                AutoHeight: =true
                Font: =Font.'Lato Black'
                FontWeight: =FontWeight.Semibold
                Height: =34
                Text: =Parent.DisplayName
                Width: =(Parent.Width - 60) * 0.4
                Wrap: =false
                X: =30
                Y: =10 + (visitorPhoneNumber_2.Height / 2) - (Self.Height / 2)
                ZIndex: =1

            visitorPhoneNumber_2 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Clear: =true
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Format: =TextFormat.Number
                HintText: ="9XXX"
                MaxLength: =Parent.MaxLength
                OnChange: |-
                    =Set(_lastEnteredPhoneNumber, visitorPhoneNumber_2.Text);
                    //If(IsEmpty(LookUp(VisitorInformation, 'Phone Number' = visitorPhoneNumber.Text)),Icon.Cancel,Icon.Check);
                    //If(CountRows(Filter(VisitorInformation,'Phone Number' = visitorPhoneNumber.Text))>0,Notify("Phone Number already exists. Enter your correct phone number.",NotificationType.Error));
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                VirtualKeyboardMode: =VirtualKeyboardMode.Numeric
                Width: =(Parent.Width - 60) * 0.6
                X: =225
                Y: =10
                ZIndex: =2

            ErrorMessage6_2 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =visitorPhoneNumber_2.Y + visitorPhoneNumber_2.Height
                ZIndex: =3

            StarVisible6_2 As label:
                Align: =Align.Center
                Height: =DataCardKey6_2.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey6_2.Y
                ZIndex: =4

            right_17 As icon.Check:
                Color: =If(Self.Icon=Icon.Check, Green, Red)
                DisplayMode: =DisplayMode.View
                Height: =38
                Icon: =If(!IsBlank(visitorPhoneNumber_2.Text) && IsMatch(visitorPhoneNumber_2.Text,Digit & Digit & Digit & Digit & Digit & Digit & Digit &Digit & Digit & Digit) && CountRows(Filter(VisitorPhoneNumber,'Phone Number'=visitorPhoneNumber_2.Text))<=0,Icon.Check,Icon.Cancel)
                Width: =46
                X: =578
                Y: =12
                ZIndex: =5

    companyName_8 As companyName:
        X: =213
        Y: =20
        ZIndex: =7

